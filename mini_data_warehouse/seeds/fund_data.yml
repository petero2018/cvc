version: 2

seeds:
  - name: fund_data
    description: Raw fund transaction extract.
    columns:
      - name: fund_name
        tests:
          - not_null:
              config:
                severity: warn

      - name: transaction_type
        tests:
          - accepted_values:
              values: ['Commitment','Valuation','Call','Distribution']
              config:
                severity: warn

      - name: transaction_date
        tests:
          - not_null:
              config:
                severity: warn
          - dbt_utils.expression_is_true:
              arguments:
                expression: "to_date(transaction_date, 'DD/MM/YYYY') is not null"
              config:
                severity: warn

      - name: fund_size
        tests:
          - not_null:
              config:
                severity: warn
          - dbt_utils.expression_is_true:
              arguments:
                expression: "to_number(regexp_replace(fund_size, '[, ]', '')) is not null"
              config:
                severity: warn

      - name: transaction_index
        tests:
          - dbt_utils.expression_is_true:
              arguments:
                expression: "to_number(regexp_replace(transaction_index, '[, ]', '')) is not null"
              config:
                severity: warn

      - name: transaction_amount
        tests:
          - not_null:
              config:
                severity: warn
